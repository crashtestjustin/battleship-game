(()=>{"use strict";const t=t=>({name:t,length:(()=>{switch(t){case"Carrier":return 5;case"Battleship":return 4;case"Destroyer":case"Submarine":return 3;case"Patrol Boat":return 2;default:return 0}})(),hitCount:0,sunk:!1,hit:function(){this.hitCount++,this.isSunk()},isSunk:function(){this.hitCount>=this.length&&(this.sunk=!0)}}),e=()=>({boardArray:[],missedGuesses:[],hitGuesses:[],shipsLeft:["Carrier","Battleship","Submarine","Destroyer","Patrol Boat"],shipsSunk:0,shipObjects:[],highlightedCoordinates:[],placeShipsRandom:function(){for(let e=0;e<this.shipsLeft.length;e++){let n=Math.random()>=.5,o=t(this.shipsLeft[e]),r=this.placeShipRecursive(o,n);this.boardArray.push(r),this.shipObjects.push(o),o.location=r}},placeShipRecursive:function(t,e){let o=n(),r=this.checkValidPlacement(t,o,e);return r?this.checkForShipOverlap(r)?this.placeShipRecursive(t,e):r:this.placeShipRecursive(t,e)},placeShipsManual:function(e){const n=document.querySelector("#is-vert"),o=document.querySelectorAll(".p-grid"),r=document.querySelector(".body-title");let a,s=0;const i=h=>{const u=h.target,d=JSON.parse(u.id),p=this.shipsLeft[s];let f;if(a=t(p),f=n.checked?this.checkValidManualPlacement(a,d,!0):this.checkValidManualPlacement(a,d,!1),f){if(this.checkForShipOverlap(f))return;console.log(f),a.location=f,this.shipObjects.push(a),this.boardArray.push(f),s++,s===this.shipsLeft.length?(o.forEach((t=>{t.removeEventListener("click",i),t.removeEventListener("mouseover",c),t.removeEventListener("mouseout",l)})),e()):r.textContent=`Place your ${this.shipsLeft[s]}.`}},c=e=>{const o=e.target,r=JSON.parse(o.id),a=this.shipsLeft[s],i=t(a);n.checked?i.location&&i.location.length>0?i.location.forEach((t=>{document.getElementById(JSON.stringify(t)).style.backgroundColor="orange"})):(i.location=this.checkValidManualPlacement(i,r,!0),this.searchValuesAbove9(i.location)||this.checkForShipOverlap(i.location)?i.location.forEach((t=>{document.getElementById(JSON.stringify(t)).style.backgroundColor="red"})):i.location.forEach((t=>{document.getElementById(JSON.stringify(t)).style.backgroundColor="orange"}))):i.location&&i.location.length>0?i.location.forEach((t=>{document.getElementById(JSON.stringify(t)).style.backgroundColor="orange"})):(i.location=this.checkValidManualPlacement(i,r,!1),this.searchValuesAbove9(i.location)||this.checkForShipOverlap(i.location)?i.location.forEach((t=>{document.getElementById(JSON.stringify(t)).style.backgroundColor="red"})):i.location.forEach((t=>{document.getElementById(JSON.stringify(t)).style.backgroundColor="orange"})))},l=e=>{const o=e.target,r=JSON.parse(o.id),a=this.shipsLeft[s],i=t(a);n.checked?i.location=this.checkValidManualPlacement(i,r,!0):i.location=this.checkValidManualPlacement(i,r,!1),i.location&&this.boardArray.forEach((t=>{t.forEach((t=>{document.getElementById(JSON.stringify(t)).style.backgroundColor="orange"}))})),console.log(i.location),i.location.forEach((t=>{document.getElementById(JSON.stringify(t)).style.backgroundColor="transparent"})),this.shipObjects.forEach((t=>{t.location.forEach((t=>{document.getElementById(JSON.stringify(t)).style.backgroundColor="orange"}))}))};o.forEach((t=>{t.addEventListener("click",i),t.addEventListener("mouseover",c),t.addEventListener("mouseout",l)})),r.textContent=`Place your ${this.shipsLeft[0]}.`},checkValidManualPlacement:function(t,e,n){let o=[];o.push(e);for(let r=1;r<t.length;r++){let t;t=n?[e[0]+r,e[1]]:[e[0],e[1]+r],o.push(t)}return o},checkValidPlacement:function(t,e,n){let o=[];if(o.push(e),n&&e[0]+t.length>10)return!1;if(!n&&e[1]+t.length>10)return!1;for(let r=1;r<t.length;r++){let t;if(t=n?[e[0]+r,e[1]]:[e[0],e[1]+r],this.compareArrays(t))return!1;o.push(t)}return o},checkForShipOverlap:function(t){for(let e=0;e<this.shipObjects.length;e++){const n=this.shipObjects[e].location;for(let e=0;e<t.length;e++){const o=t[e];for(let t=0;t<n.length;t++){const e=n[t];if(e[0]===o[0]&&e[1]===o[1])return!0}}}return!1},compareArrays:function(t,e){let n=!1;if(void 0===e)for(let e=0;e<this.boardArray.length;e++){const o=this.boardArray[e];for(let e=0;e<o.length;e++)if(o[e][0]===t[0]&&o[e][1]===t[1]){n=!0;break}if(n)break}else for(let o=0;o<t.length;o++)if(t[o][0]===e[0]&&t[o][1]===e[1]){n=!0;break}return n},searchValuesAbove9:function(t){for(let e=0;e<t.length;e++)for(let n=0;n<t[e].length;n++)if(t[e][n]>9)return!0;return!1},checkForAllSunk:function(){let t=0;for(let e=0;e<this.shipObjects.length;e++)this.shipObjects[e].sunk&&t++;return this.shipsSunk=t,t},receiveAttack:function(t){let e=null;for(let n=0;n<this.shipObjects.length;n++){const o=this.shipObjects[n].location;if(this.compareArrays(o,t)){if(this.shipObjects[n].hit(),this.hitGuesses.push(t),e=this.shipObjects[n],e.sunk){this.shipsLeft=[];for(let t=0;t<this.shipObjects.length;t++)this.shipObjects[t].sunk||this.shipsLeft.push(this.shipObjects[t].name)}break}}if(null!==e){const t=this.checkForAllSunk();return 5===t?t:e}return this.missedGuesses.push(t),t}});function n(){return[parseInt(10*Math.random()),parseInt(10*Math.random())]}const o=t=>({name:t,CPU:"CPU"===t,oponentGameboard:e(),attackHistory:[],checkAttackHist:function(t){let e=this.attackHistory;for(let n of e)if(n[0]===t[0]&&n[1]===t[1])return!0;return!1},submitAttack:function(t){if(void 0!==t&&this.checkAttackHist(t))return console.log("invalid guess"),"invalid guess";if(void 0===t){let e;do{e=n()}while(this.checkAttackHist(e));t=e}const e=this.oponentGameboard.receiveAttack(t);return this.attackHistory.push(t),e},announceAsWinner:function(){const t=`${this.name} has won the game!`;return console.log(t),t}});function r(t,e){console.log(t);const n=document.querySelectorAll(".all-p-ships"),o=document.querySelectorAll(".all-c-ships");if(void 0===t&&void 0===e)return n.forEach((t=>{t.style.textDecoration="none",t.style.opacity="1"})),void o.forEach((t=>{t.style.textDecoration="none",t.style.opacity="1"}));"CPU"===e?n.forEach((e=>{("final"===t||e.textContent===t.name)&&(e.style.textDecoration="line-through",e.style.opacity="0.25")})):o.forEach((e=>{("final"===t||e.textContent===t.name)&&(e.style.textDecoration="line-through",e.style.opacity="0.25")}))}function a(t,e,n){const o=document.querySelectorAll(".c-grid"),r=document.querySelectorAll(".p-grid");"user"===e?void 0!==n?o.forEach((t=>{const e=JSON.parse(t.id);n.forEach((n=>{n.location.forEach((n=>{n[0]===e[0]&&n[1]===e[1]&&(t.textContent="X",t.style.backgroundColor="var(--sunk-attack)")}))}))})):o.forEach((e=>{const n=JSON.parse(e.id);t.location.forEach((t=>{n[0]===t[0]&&n[1]===t[1]&&(e.textContent="X",e.style.backgroundColor="var(--sunk-attack)")}))})):void 0!==n?r.forEach((t=>{const e=JSON.parse(t.id);n.forEach((n=>{n.location.forEach((n=>{n[0]===e[0]&&n[1]===e[1]&&(t.textContent="X",t.style.backgroundColor="var(--sunk-attack)")}))}))})):r.forEach((e=>{const n=JSON.parse(e.id);t.location.forEach((t=>{n[0]===t[0]&&n[1]===t[1]&&(e.textContent="X",e.style.backgroundColor="var(--sunk-attack)")}))}))}function s(t,e){const n=document.createElement("div");return n.className=t,n.id=e,"undefined"===n.id&&(n.id=t),n}function i(t,e,n,o){const r=document.createElement("input");return r.type=t,r.id=e,r.placeholder=o,r}function c(t){const e=[];for(let t=0;t<10;t++)for(let n=0;n<10;n++){let o=[t,n];e.push(o)}return e[t]}!function(){const t=document.querySelector(".application"),e=function(){const t=s("header"),e=s("title");return e.textContent="Battleship Game",t.appendChild(e),t}();t.appendChild(e);const n=function(){const t=s("body"),e=s("body-title");e.textContent="Provide your name to start the game.";const n=s("game-inputs"),o=s("player-name-title");o.textContent="Your Name:";const r=i("text","name",0,"Enter your name captain!"),a=s("radio-div"),l=s("random-div"),h=document.createElement("label");h.innerHTML="Random";const u=i("radio","radio1",0,"random");u.name="option",l.append(h,u);const d=s("place-div"),p=document.createElement("label");p.innerHTML="Place Ships";const f=i("radio","radio2",0,"place");f.name="option",d.append(p,f);const m=s("vertical-select"),g=document.createElement("label");g.innerHTML="Vertical";const y=i("checkbox","is-vert");m.append(g,y),a.append(l,d,m);const k=function(t,e){const n=document.createElement("button");return n.className="start-game",n.textContent="Start Game",n}();n.append(o,r,a,k);const C=s("board-section"),b=s("board-titles");b.classList.add("p-board-titles");const v=s("player-board-title");v.textContent="Your Fleet",b.appendChild(v);const S=s("move-result");S.classList.add("p-move-result"),S.textContent="⛴️",b.appendChild(S);const E=s("board-div");E.classList.add("player-board");for(let t=0;t<100;t++){const e=s("grid-square",JSON.stringify(c(t)));e.classList.add("p-grid"),E.appendChild(e)}const O=s("board-titles");O.classList.add("c-board-titles");const x=s("cpu-board-title");x.textContent="Sink Enemy Ships!",O.appendChild(x);const A=s("move-result");A.classList.add("c-move-result"),A.textContent="⛴️",O.appendChild(A);const L=s("board-div");L.classList.add("cpu-board");for(let t=0;t<100;t++){const e=s("grid-square",JSON.stringify(c(t)));e.classList.add("c-grid"),L.appendChild(e)}C.append(b,E,O,L);const N=["Carrier","Battleship","Destroyer","Submarine","Patrol Boat"],P=s("ship-lists"),J=s("player-list"),q=s("ships-title");q.textContent="Your Ships Left";const M=s("p-ship-list");for(let t=0;t<N.length;t++){const e=s(`${N[t]}`);e.classList.add("all-p-ships"),e.textContent=`${N[t]}`,M.appendChild(e)}const j=s("cpu-list"),B=s("ships-title");B.textContent="CPU Ships Left";const G=s("c-ship-list");for(let t=0;t<N.length;t++){const e=s(`${N[t]}`);e.classList.add("all-c-ships"),e.textContent=`${N[t]}`,G.appendChild(e)}return J.append(q,M),j.append(B,G),P.append(J,j),t.appendChild(e),t.append(n,C,P),t}();t.appendChild(n);const o=function(){const t=s("footer"),e=s("title"),n=document.createElement("span");n.textContent="Created by ";const o=document.createElement("a");return o.href="https://github.com/crashtestjustin/battleship-game",o.textContent="Justin Elliott",e.append(n,o),t.appendChild(e),t}();t.appendChild(o)}(),function(){const t=document.querySelector(".body-title"),e=document.querySelector(".start-game"),n=document.querySelectorAll(".grid-square"),s=document.querySelectorAll(".p-grid"),i=document.querySelectorAll(".c-grid"),c=document.querySelector(".p-move-result"),l=document.querySelector(".c-move-result");let h,u,d,p=!0;function f(e){return t.textContent=`Awaiting ${d.name}'s attack.`,h=u.submitAttack(JSON.parse(e.target.id)),"invalid guess"===h?h:(5===h&&(e.target.style.backgroundColor="var(--hit-attack)",console.log("Game Over"),p=!1),Array.isArray(h)&&(e.target.style.backgroundColor="var(--missed-attack)",l.textContent="You Missed! ❌",console.log("MISS")),Array.isArray(h)||5===h||(e.target.style.backgroundColor="var(--hit-attack)",console.log(h),h.sunk?(l.textContent=`You sunk their ${h.name}!`,r(h,"user"),a(h,"user")):l.textContent="You hit a ship! 🫡"),p?void setTimeout((function(){if(h=d.submitAttack(),"invalid guess"===h)return h;if(5===h){let e=d.attackHistory.slice(-1);return s.forEach((t=>{let n=JSON.parse(t.id);n[0]===e[0][0]&&n[1]===e[0][1]&&(t.style.backgroundColor="var(--hit-attack)")})),console.log("Game Over"),t.textContent=d.announceAsWinner(),r("final","CPU"),a(h,"CPU",d.oponentGameboard.shipObjects),c.textContent="(You = LOSER)",l.textContent="(CPU = WINNER!)",p=!1,void i.forEach((t=>{t.removeEventListener("click",f)}))}if(Array.isArray(h)&&(s.forEach((t=>{let e=JSON.parse(t.id);h[0]===e[0]&&h[1]===e[1]&&(t.style.backgroundColor="var(--missed-attack)")})),c.textContent="CPU Missed! ❌",console.log("MISS")),!Array.isArray(h)&&5!==h){let t=d.attackHistory.slice(-1);s.forEach((e=>{let n=JSON.parse(e.id);n[0]===t[0][0]&&n[1]===t[0][1]&&(e.style.backgroundColor="var(--hit-attack)")})),console.log(h),h.sunk?(c.textContent=`CPU has sunk your ${h.name}! 🥲🪦`,r(h,"CPU"),a(h,"CPU")):c.textContent="CPU has hit a ship! 😬"}t.textContent=`Awaiting ${u.name}'s attack.`}),500):(t.textContent=u.announceAsWinner(),r("final","user"),a(h,"user",u.oponentGameboard.shipObjects),l.textContent="(CPU = LOSER)",c.textContent="(You = WINNER!)",void i.forEach((t=>{t.removeEventListener("click",f)}))))}e.addEventListener("click",(e=>{function a(){d.oponentGameboard.boardArray.forEach((t=>{t.forEach((t=>{for(let e=0;e<s.length;e++){const n=JSON.parse(s[e].id);t[0]===n[0]&&t[1]===n[1]&&(s[e].style.backgroundColor="var(--ship-color)")}}))})),t.textContent=`Awaiting ${u.name}'s attack.`,i.forEach((t=>{t.addEventListener("click",f)}))}p=!0,c.textContent="⛴️",l.textContent="⛴️",n.forEach((t=>{t.style.backgroundColor="transparent",t.textContent=""})),r(),i.forEach((t=>{t.removeEventListener("click",f)})),u=o(document.querySelector("#name").value),d=o("CPU"),u.oponentGameboard.placeShipsRandom(),document.querySelector("#radio2").checked?d.oponentGameboard.placeShipsManual(a):(d.oponentGameboard.placeShipsRandom(),a())}))}()})();